<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>开学季-趣味成语大赛中奖名单页</title>
		<style type="text/css">
			* {
				margin: 0px;
				padding: 0px;
				list-style: none;
			}
			
			#main {
				position: relative;
				left: 0px;
				top: 0px;
				background: url(img/namelist/namelistBG.jpg) no-repeat;
				width: 1280px;
				height: 720px;
				overflow: hidden;
			}
			/*中奖名单*/
			
			#nameListTan {
				position: absolute;
				left: 0px;
				top: 0px;
				width: 100%;
				height: 100%;
				background: url(../img/rule-nameList/nameList.png) no-repeat;
				visibility: hidden;
			}
			
			#nameListBack {
				position: absolute;
				right: 30px;
				top: 30px;
			}
			
			#hands_x0_y0_nameListBackFocus_ img {
				position: absolute;
				right: 30px;
				top: 30px;
				visibility: hidden;
			}
			
			#telInput {
				position: absolute;
				left: 500px;
				bottom: 172px;
				font-size: 20px;
				color: #fff;
			}
			
			#prizeInfo {
				position: absolute;
				left: 910px;
				bottom: 227px;
				font-size: 16px;
				color: #fff;
			}
			
			#userInfo {
				position: absolute;
				left: 450px;
				bottom: 225px;
				font-size: 16px;
				color: #fff;
			}
			
			#hands_x0_y0_inputFocus_ img {
				position: absolute;
				left: 430px;
				bottom: 152px;
				visibility: hidden;
			}
			
			#hands_x0_y0_saveFocus_ img {
				position: absolute;
				left: 736px;
				bottom: 152px;
				visibility: hidden;
			}
			
			#hands_x0_y0_emptyFocus_ img {
				position: absolute;
				left: 840px;
				bottom: 152px;
				visibility: hidden;
			}
			
			#nameList {
				position: absolute;
				left: 380px;
				top: 200px;
				width: 540px;
				color: #FFFFFF;
				font-size: 20px;
			}
			
			#nameList>li span:nth-child(1) {
				float: left;
				width: 50%;
				text-align: left;
			}
			
			#nameList>li span:nth-child(2) {
				float: left;
				width: 50%;
				text-align: right;
			}
		</style>
	</head>

	<body>
		<div id="main">
			<!--手机号输入框-->
			<div id="telInput"></div>
			<div id="hands_x0_y0_inputFocus_">
				<img src="img/namelist/inputFocus.png" id="inputFocus" />
			</div>
			<!--保存-->
			<div id="hands_x0_y0_saveFocus_">
				<img src="img/namelist/btnFocus.png" id="saveFocus" />
			</div>
			<!--保存提示-->
			<div id="savetips" style="position: absolute;left: 500px;top: 570px;color: #fff;font-size: 20px;"></div>
			<!--清除-->
			<div id="hands_x0_y0_emptyFocus_">
				<img src="img/namelist/btnFocus.png" id="emptyFocus" />
			</div>
			<!--用户信息-->
			<div id="userInfo"></div>
			<!--中奖情况-->
			<div id="prizeInfo"></div>
			<!--名单列表-->
			<ul id="nameList">
				<li><span>189****7710</span><span>20元话费</span></li>				
			</ul>
		</div>
		<!--引入公用JS-->
		<script type="text/javascript" src="../../../js/column.js"></script>
		<script type="text/javascript" src="./js/actiComm.js"></script>
		<!--引用结束-->
		<script type="text/javascript">
			/*
			 * 获取当前活动获奖名单
			 * 获取当前用户获奖信息
			 * 获取用户手机号
			 * 保存手机号
			 */
			//焦点数组
			var buttons = [{
				id: "hands_x0_y0_inputFocus_",
				otherFocusEvent: "javascript:onFocus(1)",
				otherBlurEvent: "javascript:onFocus(0)",
				left: "disable",
				right: "hands_x0_y0_saveFocus_",
				up: "disable",
				down: "disable",
				focusType: 7
			}, {
				id: "hands_x0_y0_saveFocus_",
				clickHandler: "javascript:saveFunc()",
				otherBlurEvent: 'javascript:saveBlur()',
				left: "hands_x0_y0_inputFocus_",
				right: "hands_x0_y0_emptyFocus_",
				up: "disable",
				down: "disable",
				focusType: 7
			}, {
				id: "hands_x0_y0_emptyFocus_",
				clickHandler: "javascript:emptyFunc()",
				left: "hands_x0_y0_saveFocus_",
				right: "disable",
				up: "disable",
				down: "disable",
				focusType: 7
			}]

			//焦点初始化
			focusInit();
			curFocus = getFocusModel6("hands_x0_y0_inputFocus_");
			curFocus.defaultFocus();

			//获奖获奖名单渲染
			actiObj.getPrizeUserInfo(function(res) {
				var html = "";
				if(res.resultMsg == "success") {
					for(var i = 0; i < res.list.length; i++) {
						html += "<li><span>" + res.list[i].USER_PHONE + "</span><span>" + res.list[i].PRIZE_CNAME + "</span></li>";
						CT.$("nameList").innerHTML = html;
					}
				}
			})

			//获取用户中奖信息
			actiObj.getUserPrizeInfo(function(res) {
				if(res.resultMsg == "success") {
					CT.$("prizeInfo").innerHTML = res.list.PRIZE_CNAME;
				} else {
					CT.$("prizeInfo").innerHTML = "未中奖";
				}
			})

			//焦点是否在输入框上
			var isOnFocus;

			//当前用户手机号
			var userPhone = "";

			//焦点获焦在输入框中执行的方法
			function onFocus(index) {
				isOnFocus = index == 1 ? true : false;
			}

			//手机号输入框
			var telInput = document.getElementById("telInput").innerHTML;
			//去除字符串内所有的空格
			telInput = telInput.replace(/\s*/g, "");
			//获取手机号
			actiObj.getUserPhone(function(res) {
				if(res.userPhone != null) {
					document.getElementById("telInput").innerHTML = res.userPhone;
					phoneNum = res.userPhone;
					CT.$("userInfo").innerHTML = phoneNum;
				}
			})

			var phoneNum = telInput;
			//监听用户遥控器输入的数字
			function changeNum(num) {
				if(isOnFocus) {
					var size;
					if(phoneNum == "") {
						size = 0;
					} else {
						size = phoneNum.length;
					}
					if(size < 11 || !size) {
						var addnum = phoneNum;
						phoneNum = addnum + num;
					}
					document.getElementById("telInput").innerHTML = phoneNum;
				}
			}

			//保存手机号
			function saveFunc() {
				var phoneNum = document.getElementById("telInput").innerHTML;
				if(phoneNum.length != 11) {
					document.getElementById("telInput").innerHTML = "请输入11位手机号码";
				} else {
					actiObj.setUserPhone(phoneNum, function(res) {
						phoneNum = res.userphone;
						CT.$("userInfo").innerHTML = document.getElementById("telInput").innerHTML;
					})
					document.getElementById("savetips").innerHTML = "手机号保存成功";
				}
			}

			//保存按钮失去焦点
			function saveBlur() {
				document.getElementById("savetips").innerHTML = "";
			}

			//修改、清除手机号
			function emptyFunc() {
				document.getElementById("telInput").innerHTML = "";
				phoneNum = "";
			}

			//返回
			function backfunc() {
				window.location.href = "actiTermBeginsMain.html";
			}
		</script>
	</body>

</html>