webpackJsonp([12],{Eyz4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("mvHQ"),r=a.n(i),o=a("zL8q"),n=a("nfHz"),l=a("RcBM"),s=a("VxYR"),m={data:function(){return{formLabelWidth:"120px",themeConfigForm:{id:"",themeCname:"",themeEname:"",startTime:"",endTime:""},dialogFormTheme:!1,rules:{themeCname:[{required:!0,message:"请输入中文主题名称",trigger:"blur"}],themeEname:[{required:!0,message:"请输入英文主题名称",trigger:"blur"}]}}},created:function(){var e=this;n.a.$on("addTheme",function(){e.addTheme()}),n.a.$on("editTheme",function(t){e.editTheme(t)})},methods:{addTheme:function(){this.dialogFormTheme=!0,this.themeConfigForm.themeCname="",this.themeConfigForm.themeEname="",this.themeConfigForm.booleanUp="",this.themeConfigForm.startTime="",this.themeConfigForm.endTime=""},editTheme:function(e){this.dialogFormTheme=!0,this.themeConfigForm.id=e.id,this.themeConfigForm.themeCname=e.themeCname,this.themeConfigForm.themeEname=e.themeEname,this.themeConfigForm.booleanUp=e.booleanUp,this.themeConfigForm.startTime=e.startTime,this.themeConfigForm.endTime=e.endTime},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a=void 0;a=t.themeConfigForm.id?"axios_update_theme":"axios_add_theme",t.$store.dispatch(a,{id:t.themeConfigForm.id||void 0,themeCname:t.themeConfigForm.themeCname,themeEname:t.themeConfigForm.themeEname,booleanUp:t.themeConfigForm.booleanUp,startTime:t.themeConfigForm.startTime,endTime:t.themeConfigForm.endTime}).then(function(e){"1000"==e.data.errorCode?(t.$emit("refreshList"),Object(o.Message)({message:e.data.errorMsg,type:"success"})):Object(o.Message)({message:e.data.errorMsg,type:"error"})}).catch(function(e){t.$message.error("操作失败")}),t.dialogFormTheme=!1})}},beforeDestroy:function(){n.a.$off(["addTheme","editTheme","refreshList"])}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],ref:"dialog__wrapper",attrs:{width:"50vw",height:"50",title:e.themeConfigForm.id?"编辑":"新增",visible:e.dialogFormTheme},on:{"update:visible":function(t){e.dialogFormTheme=t}}},[a("el-form",{ref:"themeConfigForm",attrs:{model:e.themeConfigForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"主题中文名称",prop:"themeCname","label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"40%"},attrs:{type:"text"},model:{value:e.themeConfigForm.themeCname,callback:function(t){e.$set(e.themeConfigForm,"themeCname",t)},expression:"themeConfigForm.themeCname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"主题英文名称",prop:"themeEname","label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"40%"},attrs:{type:"text"},model:{value:e.themeConfigForm.themeEname,callback:function(t){e.$set(e.themeConfigForm,"themeEname",t)},expression:"themeConfigForm.themeEname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"开始时间","label-width":e.formLabelWidth}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.themeConfigForm.startTime,callback:function(t){e.$set(e.themeConfigForm,"startTime",t)},expression:"themeConfigForm.startTime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"结束时间","label-width":e.formLabelWidth}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.themeConfigForm.endTime,callback:function(t){e.$set(e.themeConfigForm,"endTime",t)},expression:"themeConfigForm.endTime"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("themeConfigForm")}}},[e._v("提 交")])],1)],1)],1)},staticRenderFns:[]};var h=a("VU/8")(m,c,!1,function(e){a("KtMx")},"data-v-72b767aa",null).exports,g=a("QoLB"),d=a("PbWJ"),u=a.n(d),f={name:"",inject:["getThemeData"],data:function(){return{id:"",imagesBaseUrl:window.configs.static_IMAGES_BASEURL,attrConfigForm:{BGM1:"",BGM3:"",BGM2:"",bgimg:{id:"",picPath:""},attributeExplain:"",themeFlag:"",themeId:"",themeName:this.getThemeData(),DetailName:""},ImgList:"",imgList:[],attrId:"",attrName:"",dictLabel:"",curBgImg1:u.a,curBgImg2:u.a,curBgImg3:u.a,formLabelWidth:"120px",themeDataList:[],DetailDataList:[],dialogSetTheme:!1,rules:{}}},components:{image_choice:g.a},mounted:function(){this.getTheme(),this.getDetail()},created:function(){var e=this;console.log(this.getThemeData()),n.a.$on("addThemeAttr",function(){e.addThemeAttr()}),n.a.$on("editThemeAttr",function(t){e.editThemeAttr(t)})},methods:{setImg:function(e,t){this.dialogFormVisible=!0,this.attrConfigForm.bgimg=e;1==t&&(this.curBgImg1=e.picPath),2==t&&(this.curBgImg2=e.picPath),3==t&&(this.curBgImg3=e.picPath)},selectChange:function(e){this.attrId=e,console.log(this.attrId)},getTheme:function(){var e=this;this.$store.dispatch("axios_get_themeList",{searchValue:"",pageNum:1,pageSize:10}).then(function(t){console.log(t),e.themeDataList=t.data.data.records}).catch()},getDetail:function(){var e=this;this.$store.dispatch("axios_get_selectDictDataByType",{dictType:"SYS_THEME_CONFIG"}).then(function(t){console.log(t),e.DetailDataList=t.data.data,console.log(e.DetailDataList)}).catch()},addThemeAttr:function(){this.dialogSetTheme=!0,this.attrConfigForm.attributeExplain="",this.curBgImg1="",this.curBgImg2="",this.curBgImg3="",this.attrConfigForm.themeId=this.getThemeData().id},editThemeAttr:function(e){var t;t=e.attributeValue.split(","),console.log("编辑前带过来的---------"+t),console.log(t[0]),this.dialogSetTheme=!0,this.attrConfigForm.id=e.id,this.curBgImg1=t[0],this.curBgImg2=t[1],this.curBgImg3=t[2],console.log("curBgImg1-----"+this.curBgImg1),console.log("curBgImg2-----"+this.curBgImg2),console.log("curBgImg3-----"+this.curBgImg3),this.attrConfigForm.attributeExplain=e.attributeExplain,this.attrConfigForm.themeId=this.getThemeData().id,this.selectChange(this.attrConfigForm.attributeExplain)},onSubmit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;var a=[];a.push(t.curBgImg1),a.push(t.curBgImg2),a.push(t.curBgImg3),t.ImgList=a.join(","),console.log(t.ImgList);var i=void 0;i=t.attrConfigForm.id?"axios_update_themeDetail":"axios_add_themeDetail";for(var r=0;r<t.DetailDataList.length;r++)t.DetailDataList[r].remark==t.attrId&&(t.attrName=t.DetailDataList[r].remark,t.dictLabel=t.DetailDataList[r].dictLabel,console.log(t.attrName));t.$store.dispatch(i,{id:t.attrConfigForm.id||void 0,attributeExplain:t.attrName,attributeKey:t.dictLabel,attributeValue:t.ImgList,themeId:t.attrConfigForm.themeId}).then(function(e){"1000"==e.data.errorCode?(t.$emit("refreshAttrList"),t.dialogSetTheme=!1,t.attrConfigForm.id=null,t.ImgList="",Object(o.Message)({message:e.data.errorMsg,type:"success"})):Object(o.Message)({message:e.data.errorMsg,type:"error"})}).catch(function(e){t.$message.error("操作失败")})})}},beforeDestroy:function(){n.a.$off("addThemeAttr","editThemeAttr","refreshAttrList")}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{attrs:{width:"30vw",title:"主题属性详情设置",visible:e.dialogSetTheme},on:{"update:visible":function(t){e.dialogSetTheme=t}}},[a("el-form",{ref:"attrConfigForm",attrs:{model:e.attrConfigForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"主题","label-width":e.formLabelWidth}},[a("el-input",{staticStyle:{width:"40%"},attrs:{disabled:!0},model:{value:e.attrConfigForm.themeName.name,callback:function(t){e.$set(e.attrConfigForm.themeName,"name",t)},expression:"attrConfigForm.themeName.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"属性名称",prop:"attrName","label-width":e.formLabelWidth}},[a("el-select",{attrs:{filterable:"","allow-create":"","default-first-option":"",placeholder:"请选择","value-key":"attrConfigForm.attributeExplain"},on:{change:e.selectChange},model:{value:e.attrConfigForm.attributeExplain,callback:function(t){e.$set(e.attrConfigForm,"attributeExplain",t)},expression:"attrConfigForm.attributeExplain"}},e._l(e.DetailDataList,function(e){return a("el-option",{key:e.id,attrs:{label:e.remark,value:e.remark}})}),1)],1),e._v(" "),a("el-form-item",{attrs:{label:"背景图片","label-width":e.formLabelWidth}},[a("el-popover",{attrs:{placement:"right",width:"535",trigger:"hover"}},[a("el-input",{style:{display:"none"},attrs:{autocomplete:"off"},model:{value:e.attrConfigForm.BGM1,callback:function(t){e.$set(e.attrConfigForm,"BGM1",t)},expression:"attrConfigForm.BGM1"}}),e._v(" "),a("img",{staticClass:"flagImage",attrs:{slot:"reference",src:e.imagesBaseUrl+e.curBgImg1},slot:"reference"}),e._v(" "),a("image_choice",{on:{getSelectImage:function(t){return e.setImg(t,1)}}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"标签图片","label-width":e.formLabelWidth}},[a("el-popover",{attrs:{placement:"right",width:"535",trigger:"hover"}},[a("el-input",{style:{display:"none"},attrs:{autocomplete:"off"},model:{value:e.attrConfigForm.BGM2,callback:function(t){e.$set(e.attrConfigForm,"BGM2",t)},expression:"attrConfigForm.BGM2"}}),e._v(" "),a("img",{staticClass:"flagImage",attrs:{slot:"reference",src:e.imagesBaseUrl+e.curBgImg2},slot:"reference"}),e._v(" "),a("image_choice",{on:{getSelectImage:function(t){return e.setImg(t,2)}}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"焦点图片","label-width":e.formLabelWidth}},[a("el-popover",{attrs:{placement:"right",width:"535",trigger:"hover"}},[a("el-input",{style:{display:"none"},attrs:{autocomplete:"off"},model:{value:e.attrConfigForm.BGM3,callback:function(t){e.$set(e.attrConfigForm,"BGM3",t)},expression:"attrConfigForm.BGM3"}}),e._v(" "),a("img",{staticClass:"flagImage",attrs:{slot:"reference",src:e.imagesBaseUrl+e.curBgImg3},slot:"reference"}),e._v(" "),a("image_choice",{on:{getSelectImage:function(t){return e.setImg(t,3)}}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",style:{"text-align":"center"},attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("attrConfigForm")}}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var b=a("VU/8")(f,p,!1,function(e){a("QDn1")},"data-v-74d89740",null).exports,v={provide:function(){var e=this;return{getThemeData:function(){return e.themeData}}},data:function(){return{imagesBaseUrl:window.configs.static_IMAGES_BASEURL,switchValue:!0,currentPage:1,pageSize:10,currentPageAttr:1,pageSizeAttr:10,total:1,totalAttr:1,attrDelId:"",themeId:"",themeDate:[],tableData:[],tableDataDetail:[],themeData:[],dialogTheme:!1,online:{0:"下架",2:"上架"},Flag:{0:"默认主题",1:"当前主题",2:"预设主题",3:"普通主题"}}},components:{keySearch:s.a,Pagination:l.a,configTheme:h,configThemeAttr:b},mounted:function(){this.getTheme()},methods:{spileDate:function(e){if(e)return e.split(" ")[0]},splitImg:function(e){e.split(",")},getTheme:function(e){var t=this;this.$store.dispatch("axios_get_themeList",{searchValue:e,pageNum:this.currentPage,pageSize:this.pageSize}).then(function(e){console.log(e),t.tableData=e.data.data.records,t.total=e.data.data.total}).catch()},handleCreate:function(){n.a.$emit("addTheme")},handleUpdataTheme:function(e){console.log(e),n.a.$emit("editTheme",e)},handleDel:function(e){var t=this;this.$confirm("确定删除吗, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$store.dispatch("axios_del_theme",{ids:e.id}).then(function(e){"1000"==e.data.errorCode?(t.getTheme(),Object(o.Message)({message:e.data.errorMsg,type:"success"})):Object(o.Message)({message:e.data.errorMsg,type:"error"})}).catch(function(e){t.$message.error("批量操作失败，请联系管理员")})}).catch(function(){t.$message({type:"info",message:"已取消该操作！"})})},handleCheck:function(e){this.dialogTheme=!0,console.log("获取主题属性-----id"+r()(e)),this.themeData.id=e.id,this.themeData.name=e.themeCname,console.log(this.themeData),this.getThemeAttr(e)},getThemeAttr:function(e){var t=this;this.$store.dispatch("axios_get_themeDetail",{themeId:this.themeData.id,pageNum:this.currentPageAttr,pageSize:this.pageSizeAttr}).then(function(e){console.log(e),t.tableDataDetail=e.data.data.records,t.totalAttr=e.data.data.total}).catch()},handleAttrCreate:function(){n.a.$emit("addThemeAttr")},handleEditAttr:function(e){n.a.$emit("editThemeAttr",e)},handleSwitch:function(e,t){var a=this;this.$store.dispatch("axios_update_themeChange",{themeId:t.id,status:e}).then(function(i){"1000"==i.data.errorCode?(Object(o.Message)({message:i.data.errorMsg,type:"success"}),a.getTheme()):(t.booleanUp=2==e?0:2,Object(o.Message)({message:i.data.errorMsg,type:"error"}))}).catch(function(i){t.booleanUp=2==e?0:2,a.$message.error("批量操作失败，请联系管理员")})},handleDetailDel:function(e){var t=this;this.$confirm("确定删除吗, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$store.dispatch("axios_del_themeDetail",{ids:e.id}).then(function(e){"1000"==e.data.errorCode?(t.getThemeAttr(t.themeData),Object(o.Message)({message:e.data.errorMsg,type:"success"})):Object(o.Message)({message:e.data.errorMsg,type:"error"})}).catch(function(e){t.$message.error("批量操作失败，请联系管理员")})}).catch(function(){t.$message({type:"info",message:"已取消该操作！"})})},handleDetailUpdate:function(e){console.log(e)}}},_={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{}},[a("keySearch",{on:{searchData:e.getTheme}}),e._v(" "),a("el-button",{style:{float:"right",margin:"0 10px 0 0"},attrs:{type:"warning",plain:""},on:{click:e.handleCreate}},[e._v("新增")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{fixed:"",prop:"id",label:"主题ID"}}),e._v(" "),a("el-table-column",{attrs:{prop:"themeCname",label:"主题中文名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"themeEname",label:"主题英文名"}}),e._v(" "),a("el-table-column",{attrs:{prop:"themeFlag",label:"主题状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.Flag[t.row.themeFlag]))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"startTime",label:"开始时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.spileDate(t.row.startTime)))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"endTime",label:"结束时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.spileDate(t.row.endTime)))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"booleanUp",label:"是否上架"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-value":2,"inactive-value":0,"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:function(a){return e.handleSwitch(a,t.row)}},model:{value:t.row.booleanUp,callback:function(a){e.$set(t.row,"booleanUp",a)},expression:"scope.row.booleanUp"}}),e._v("\n        "+e._s(e.online[t.row.booleanUp])+"\n      ")]}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleCheck(t.row)}}},[e._v("查看")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleUpdataTheme(t.row)}}},[e._v("更新")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDel(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.currentPage,limit:e.pageSize},on:{"update:page":function(t){e.currentPage=t},"update:limit":function(t){e.pageSize=t},pagination:e.getTheme}}),e._v(" "),a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],attrs:{width:"60vw",title:"主题详情设置",visible:e.dialogTheme},on:{"update:visible":function(t){e.dialogTheme=t}}},[a("div",{style:{"line-height":"50px",height:"50px",margin:"20px 0 0 0"}},[a("el-button",{style:{float:"right",margin:"0 10px 0 0"},attrs:{type:"warning",size:"mini",plain:""},on:{click:function(t){return e.handleAttrCreate()}}},[e._v("新增")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableDataDetail,border:""}},[a("el-table-column",{attrs:{fixed:"",prop:"attributeExplain",label:"背景类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"attributeValue",label:"背景图片"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.attributeValue.split(","),function(t,i){return a("el-image",{key:i,staticStyle:{width:"60px",height:"60px"},attrs:{src:e.imagesBaseUrl+t}})})}}])}),e._v(" "),a("el-table-column",{attrs:{fixed:"right",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleEditAttr(t.row)}}},[e._v("设置")]),e._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDetailDel(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.totalAttr>0,expression:"totalAttr>0"}],attrs:{total:e.totalAttr,page:e.currentPageAttr,limit:e.pageSizeAttr},on:{"update:page":function(t){e.currentPageAttr=t},"update:limit":function(t){e.pageSizeAttr=t},pagination:e.getThemeAttr}})],1),e._v(" "),a("configThemeAttr",{on:{refreshAttrList:function(t){return e.getThemeAttr(e.themeData)}}}),e._v(" "),a("configTheme",{on:{refreshList:e.getTheme}})],1)},staticRenderFns:[]};var C=a("VU/8")(v,_,!1,function(e){a("QKf0")},"data-v-d7df906c",null);t.default=C.exports},KtMx:function(e,t){},QDn1:function(e,t){},QKf0:function(e,t){}});