webpackJsonp([26],{"3ceg":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("zL8q"),o={name:"addFactory",data:function(){return{dialogFormVisible:!1,form:{factoryCname:"",contractNum:"",signDate:"",systemVersion:"",deviceNum:""},editUrl:"axios_edit_factory",addUrl:"axios_add_factory",formLabelWidth:"120px",rules:{factoryCname:[{required:!0,message:"必填项",trigger:"blur"}],systemVersion:[{required:!0,message:"必填项",trigger:"blur"}],deviceNum:[{required:!0,message:"必填项",trigger:"blur"}]}}},methods:{addMenu:function(){this.form={},this.dialogFormVisible=!0},editMenu:function(e){this.form=e,this.dialogFormVisible=!0},onSubmit:function(e){var t=this;this.$refs[e].validate(function(a){if(!a)return!1;t.$store.dispatch(t.form.id?t.editUrl:t.addUrl,t.form).then(function(a){"1000"==a.data.errorCode?(t.$emit("refresh"),t.$message.success("操作成功"),resetForm(e)):t.$message.error("操作失败")}).catch(function(e){t.$message.error("操作失败")}),t.dialogFormVisible=!1})},resetForm:function(e){this.$refs[e].resetFields()}}},i={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-dialog",{directives:[{name:"dialogDrag",rawName:"v-dialogDrag"}],ref:"dialog__wrapper",attrs:{width:"50vw",title:this.form.id?"编辑":"新增",visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("el-form-item",{attrs:{label:"厂商名称","label-width":e.formLabelWidth,prop:"factoryCname"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.factoryCname,callback:function(t){e.$set(e.form,"factoryCname",t)},expression:"form.factoryCname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"合同编号","label-width":e.formLabelWidth}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.contractNum,callback:function(t){e.$set(e.form,"contractNum",t)},expression:"form.contractNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"签约时间","label-width":e.formLabelWidth}},[a("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd",type:"date",placeholder:"选择日期"},model:{value:e.form.signDate,callback:function(t){e.$set(e.form,"signDate",t)},expression:"form.signDate"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"盒子类型","label-width":e.formLabelWidth,prop:"systemVersion"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.systemVersion,callback:function(t){e.$set(e.form,"systemVersion",t)},expression:"form.systemVersion"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"设备数量","label-width":e.formLabelWidth,prop:"deviceNum"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.deviceNum,callback:function(t){e.$set(e.form,"deviceNum",t)},expression:"form.deviceNum"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onSubmit("form")}}},[e._v("提 交")])],1)],1)],1)},staticRenderFns:[]};var n={name:"factoryData2",inject:["getMenuId"],components:{addFactory:a("VU/8")(o,i,!1,function(e){a("UOS/")},"data-v-369ade5e",null).exports,pagination:a("RcBM").a},data:function(){return{showVlaue:{0:"禁用",1:"启用"},factoryData:[],searchValue:"",loading:!0,tableHeight:void 0,menuId:this.getMenuId(),currentPage:1,pageSize:10,total:1}},created:function(){this.getFactoryList()},mounted:function(){this.isAuth("system:user:list")&&(this.tableHeight=window.innerHeight-this.$refs.multipleTable.$el.offsetTop-200)},methods:{getFactoryList:function(){var e=this;this.$store.dispatch("axios_get_factoryList",{pageNum:this.currentPage,pageSize:this.pageSize}).then(function(t){t&&t.data&&t.data.data&&t.data.data.records.constructor===Array&&(e.factoryData=t.data.data.records,e.total=t.data.data.total),e.loading=!1}).catch(function(t){e.loading=!1})},handleCreate:function(){this.$refs.factoryForm.addMenu()},handleEdit:function(e,t){this.$refs.factoryForm.editMenu(t[e])},handleDelete:function(e,t){var a=this;this.$confirm("此操作将永久删除该条数据, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$store.dispatch("axios_del_factory",{ids:t[e].id}).then(function(e){"1000"==e.data.errorCode?(Object(r.Message)({message:e.data.errorMsg,type:"success"}),a.getFactoryList()):Object(r.Message)({message:e.data.errorMsg,type:"warning"})}).catch(function(e){Object(r.Message)({message:"删除失败，服务器暂无响应！",type:"error"})})}).catch(function(){a.$message({type:"info",message:"已取消删除"})})},toggleSelection:function(e){var t=this;e?e.forEach(function(e){t.$refs.multipleTable.toggleRowSelection(e)}):this.$refs.multipleTable.clearSelection()},handleSelectionChange:function(e){this.multipleSelection=e}}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"btn_area"},[a("el-button",{style:{float:"right","margin-right":"70px"},attrs:{size:"mini",type:"primary",plain:""},on:{click:function(t){return e.handleCreate()}}},[e._v("新增")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.factoryData,height:e.tableHeight},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),a("el-table-column",{attrs:{prop:"factoryCname",label:"厂商名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"contractNum",label:"合同编号"}}),e._v(" "),a("el-table-column",{attrs:{prop:"signDate",label:"签约时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"systemVersion",label:"盒子类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"deviceNum",label:"设备数量"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"260"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{plain:"",size:"mini",type:"warning"},on:{click:function(a){return e.handleEdit(t.$index,e.factoryData)}}},[e._v("编 辑")]),e._v(" "),a("el-button",{attrs:{plain:"",size:"mini",type:"danger"},on:{click:function(a){return e.handleDelete(t.$index,e.factoryData)}}},[e._v("删 除")])]}}])})],1),e._v(" "),a("addFactory",{ref:"factoryForm",on:{refresh:e.getFactoryList}}),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.currentPage,limit:e.pageSize},on:{"update:page":function(t){e.currentPage=t},"update:limit":function(t){e.pageSize=t},pagination:e.getFactoryList}})],1)},staticRenderFns:[]};var s=a("VU/8")(n,l,!1,function(e){a("BZU6")},"data-v-29af7251",null);t.default=s.exports},BZU6:function(e,t){},"UOS/":function(e,t){}});